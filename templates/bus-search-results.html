<div class="container">
    <h3 class="booking-title" ng-hide="loading" > {{Bus_Result.length;}} Buses from {{SourceName}} to {{DestinationName}} on {{DateOfJourney | date : medium}} <small><a class="popup-text" href="#search-dialog" data-effect="mfp-zoom-out">Change search</a></small></h3>
    <form class="booking-item-dates-change mb30">
        <div class="row">
            <div class="col-md-3">
                <div class="form-group form-group-icon-left"><i class="fa fa-map-marker input-icon input-icon-hightlight"></i>
                    <label>From</label>
                    <input class="typeahead form-control" ng-model="SourceName" placeholder="City or Zip Code" type="text" />
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group form-group-icon-left"><i class="fa fa-map-marker input-icon input-icon-hightlight"></i>
                    <label>To</label>
                    <input class="typeahead form-control" ng-model="DestinationName" placeholder="City or Zip Code" type="text" />
                </div>
            </div>
            <div class="col-md-2">
                <div class="form-group form-group-icon-left"><i class="fa fa-calendar input-icon input-icon-hightlight"></i>
                    <label>Departing</label>
                    <input class="form-control" ui-date ui-date-format=" yy-mm-dd" ng-model="DateOfJourney">
                </div>
            </div>
            <div class="col-md-2">
                <div class="form-group form-group-select-plus">
                    <label>Passengers</label>
                    <div class="btn-group btn-group-select-num" data-toggle="buttons">
                        <label class="btn btn-primary active">
                            <input type="radio" name="options" />1</label>
                        <label class="btn btn-primary">
                            <input type="radio" name="options" />2</label>
                        <label class="btn btn-primary">
                            <input type="radio" name="options" />3</label>
                        <label class="btn btn-primary">
                            <input type="radio" name="options" />4</label>
                        <label class="btn btn-primary">
                            <input type="radio" name="options" />4+</label>
                    </div>
                    <select class="form-control hidden">
                        <option>1</option>
                        <option>2</option>
                        <option>3</option>
                        <option>4</option>
                        <option selected="selected">5</option>
                        <option>6</option>
                        <option>7</option>
                        <option>8</option>
                        <option>9</option>
                        <option>10</option>
                        <option>11</option>
                        <option>12</option>
                        <option>13</option>
                        <option>14</option>
                    </select>
                </div>
            </div>
        </div>
    </form>
    <div class="row">
        <div class="col-md-3">
            <aside class="booking-filters text-white">
                <h3>Filter By:</h3>
                <ul class="list booking-filters-list">
                    <li>
                        <h5 class="booking-filters-title">Stops <small>Price from</small></h5>
                        <div class="checkbox">
                            <label>
                                <input class="i-check" type="checkbox"> Non stop
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input class="i-check" type="checkbox"> Non stop
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input class="i-check" type="checkbox"> Non stop
                            </label>
                        </div>
                    </li>
                    <li>
                    </li>
                    <li>
                        <h5 class="booking-filters-title">Airlines</h5>
                        <div class="checkbox">
                            <label>
                                <input class="i-check" type="checkbox"/>Lufthansa
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input class="i-check" type="checkbox"/>Lufthansa
                            </label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input class="i-check" type="checkbox"/>Lufthansa
                            </label>
                        </div>
                    </li>
                    <li>
                        <h5 class="booking-filters-title">Departure Time</h5>
                        <div class="checkbox">
                            <label>
                                <input class="i-check" type="checkbox" />Morning (5:00a - 11:59a)</label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input class="i-check" type="checkbox" />Afternoon (12:00p - 5:59p)</label>
                        </div>
                        <div class="checkbox">
                            <label>
                                <input class="i-check" type="checkbox" />Evening (6:00p - 11:59p)</label>
                        </div>
                    </li>
                </ul>
            </aside>
        </div>
        <div class="col-md-9 search-tabs search-tabs-bg mb30">
            <div class="tabbable">
                <ul class="nav nav-tabs" id="myTab">
                    <li ng-class="{active:tab=='fastest'}"><a href="" data-toggle="tab" ng-click="sortType = 'duration'">Fastest Option</a>
                    </li>
                    <li ng-class="{active:tab=='cheepest'}"><a href="" data-toggle="tab" ng-click="sortType = 'available_fares'">Cheapest Option</a>
                    </li>
                    <li ng-class="{active:tab=='best_suggested'}"><a href="" data-toggle="tab" ng-click="sortType = 'duration'">Best/Suggested Option</a>
                    </li>
                </ul>
            </div>
        </div>
        <input type="text" id="route_id" style="display: none;" ng-model="route_id"/>
        <div class="col-md-7">
            <div ng-show="loading">

                <div id="floatingCirclesG">
                    <div class="f_circleG" id="frotateG_01"></div>
                    <div class="f_circleG" id="frotateG_02"></div>
                    <div class="f_circleG" id="frotateG_03"></div>
                    <div class="f_circleG" id="frotateG_04"></div>
                    <div class="f_circleG" id="frotateG_05"></div>
                    <div class="f_circleG" id="frotateG_06"></div>
                    <div class="f_circleG" id="frotateG_07"></div>
                    <div class="f_circleG" id="frotateG_08"></div>
                </div>

            </div>

            <ul ng-hide="loading" class="booking-list">
                <li ng-repeat="busses in Bus_Result | orderBy:sortType:sortReverse">
                    <div class="booking-item-container">


                        <div class="booking-item">
                            <div class="row">
                                <div class="col-md-2">

                                    <div class="booking-item-airline-logo">
                                        <img src="assets/theme/img/croatia.jpg" alt="Image Alternative text" title="Image Title" />
                                        <p>{{busses.bus_type}}</p>
                                    </div>
                                </div>
                                <div class="col-md-5">
                                    <div class="booking-item-flight-details">
                                        <div class="booking-item-departure"><i class="fa fa-bus"></i>
                                            <h5>{{ busses.departure_time | date : 'h:mm a'}}</h5>
                                            <p class="booking-item-date">{{ busses.date_of_journey | date : medium}}</p>
                                            <p class="booking-item-destination">{{busses.boarding_point_location}}</p>
                                        </div>
                                        <div class="booking-item-arrival"><i class="fa fa-bus "></i>
                                            <h5>{{ busses.arrival_time | date : 'h:mm a'}}<!--{{flight.arrivalTime}}--></h5>
                                            <p class="booking-item-destination">{{busses.dropping_point_location}}</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-2">
                                    <h5>{{busses.duration}} hour</h5>
                                </div>
                                <div class="col-md-3"><span class="booking-item-price">&#8377;{{busses.available_fares}}</span><span></span>
                                    <p class="booking-item-flight-class">Class: {{busses.service_name}}</p><a class="btn btn-primary" ng-click="showDetails(busses)" ng-href="">Select</a>
                                </div>
                            </div>
                        </div>



                        <!-- Bus Details VIew  -->

                        <div ng-if="route_id == busses.route_id" class="booking-items">


                            <div ng-show="busses.detailsLoading" class="row">
                                <div id="floatingCirclesG">
                                    <div class="f_circleG" id="frotateG_01"></div>
                                    <div class="f_circleG" id="frotateG_02"></div>
                                    <div class="f_circleG" id="frotateG_03"></div>
                                    <div class="f_circleG" id="frotateG_04"></div>
                                    <div class="f_circleG" id="frotateG_05"></div>
                                    <div class="f_circleG" id="frotateG_06"></div>
                                    <div class="f_circleG" id="frotateG_07"></div>
                                    <div class="f_circleG" id="frotateG_08"></div>
                                </div>
                            </div>

                            <div ng-hide="busses.detailsLoading" class="row">
                                <div class="col-md-12">
                                    <h4>Select Your Seat</h4>
                                    <div ng-bind-html="renderHtml(busses.seat_layout.data.BTNewSeatLayoutDetails.HTMLLayout)"></div>

                                    <div>
                                        <input id="TBSelectedSeats" name="TBSelectedSeats" ng-model="TBSelectedSeats" type="text" style="display: none;">
                                        <input id="TBSelectedSeatsPrice" name="TBSelectedSeatsPrice" ng-model="TBSelectedSeatsPrice" type="text" style="display: none;">
                                    </div>

                                    <div class="seatdesp">
                                        <div class="fleft">
                                            <ul class="seatsmall">
                                                <li class=""><dfn class="wd1"></dfn> <span>Available seat</span></li>
                                                <li class=""><dfn class="wd2"></dfn> <span>Reserved for ladies</span></li>
                                                <li class=""><dfn class="wd3"></dfn> <span>Selected seat</span></li>
                                                <li class=""><dfn class="wd4"></dfn> <span>Booked seat</span></li>
                                            </ul>
                                        </div>
                                        <div class="fleft width_100">
                                            <div style="color:Red;"> Seat(s) : {{TBSelectedSeats}}<!--<label>Seat(s)</label>:<span class="seatsSelected"><label id="selectedSeats"></label></span>--></div>
                                            <div style="color:Red;">Amount : {{TBSelectedSeatsPrice}}<!--<label>Amount</label>:<span class="seatsSelected"><label id="totalAmount"></label></span>--></div>

                                        </div>
                                    </div>







                                </div>










                                <!--<div class="col-md-4">
                                    <h4>Select Your Boarding Point</h4>
                                    <select>
                                        <option value="Place">New Delhi</option>
                                        <option value="Place">Dehradun</option>
                                    </select>
                                    ​
                                    <p class="bus_search_align">Seat No.</p>
                                    <h4 class="bus_search_align_1">Not Selected</h4>
                                    <p class="bus_search_align_2">Total Amount</p>
                                    <h4>&#x20b9;0</h4>
                                    <button class="bus_search_btn">Confirm Booking</button>
                                </div>-->​
                            </div>









                        </div>

                    </div>
                </li>

            </ul>
        </div>
          <div class="col-md-2">
            <aside class="sidebar-right">

                <div class="sidebar-widget">
                    <h4>Featured Posts</h4>
                    <ul class="thumb-list">
                        <li>
                            <a href="#">
                                <img src="assets/theme/img/viva_las_vegas_70x70.jpg" alt="Image Alternative text" title="Viva Las Vegas" />
                            </a>
                            <div class="thumb-list-item-caption">
                                <p class="thumb-list-item-meta">Jul 18, 2014</p>
                                <h5 class="thumb-list-item-title"><a href="#">Torquent ullamcorper</a></h5>
                                <p class="thumb-list-item-desciption">Justo aptent metus interdum adipiscing</p>
                            </div>
                        </li>
                        <li>
                            <a href="#">
                                <img src="assets/theme/img/4_strokes_of_fun_70x70.jpg" alt="Image Alternative text" title="4 Strokes of Fun" />
                            </a>
                            <div class="thumb-list-item-caption">
                                <p class="thumb-list-item-meta">Jul 18, 2014</p>
                                <h5 class="thumb-list-item-title"><a href="#">Sem lorem</a></h5>
                                <p class="thumb-list-item-desciption">Libero tempus non lorem inceptos</p>
                            </div>
                        </li>
                        <li>
                            <a href="#">
                                <img src="assets/theme/img/cup_on_red_70x70.jpg" alt="Image Alternative text" title="Cup on red" />
                            </a>
                            <div class="thumb-list-item-caption">
                                <p class="thumb-list-item-meta">Jul 18, 2014</p>
                                <h5 class="thumb-list-item-title"><a href="#">Libero molestie</a></h5>
                                <p class="thumb-list-item-desciption">Proin augue posuere dictumst vivamus</p>
                            </div>
                        </li>
                    </ul>
                </div>
            </aside>
        </div>

            <p ng-hide="loading" class="text-right">Not what you're looking for? <a class="popup-text" href="#search-dialog" data-effect="mfp-zoom-out">Try your search again</a>
            </p>
        </div>


      
    </div>
</div>


<script type="text/javascript">
    function AddRemoveSeat(test,seatno,htm,seatprice)
    {
        console.log("ok");
        var routeId = $("#route_id").val();
        console.log(routeId);
        if($('#'+routeId + '' + seatno))
        {
            var classOfDiv = $('#'+routeId + '' + seatno).attr("class");

            console.log(classOfDiv);

            if(classOfDiv.indexOf('s') == 0)
            {
                remove_seat(seatno,seatprice);
                $('#'+routeId + '' + seatno).attr("class",classOfDiv.substring(1, classOfDiv.length));
            }
            else
            {
                if(add_seat(seatno,seatprice))
                {
                    $('#'+routeId + '' + seatno).attr("class","s" + classOfDiv);
                }
            }
        }
    }
    function ClickReviewBook()
    {
        if(validate())
        {
            document.getElementById('CheckPost').value=true;
            document.getElementById('SeatLayout').submit();
        }
    }

    function add_seat(seatno,seatprice)
    {

        if($("#TBSelectedSeats").val())
        {
            $("#TBSelectedSeats").val($("#TBSelectedSeats").val()+","+seatno);
            $("#TBSelectedSeats").trigger('input');
        }
        else
        {
            $("#TBSelectedSeats").val(seatno);
            $("#TBSelectedSeats").trigger('input');
        }

        $("#TBSelectedSeatsPrice").val(parseFloat($("#TBSelectedSeatsPrice").val()) +  parseFloat(seatprice));
        $("#TBSelectedSeatsPrice").trigger('input');
        /*$('#selectedSeats').text($('#TBSelectedSeats').val());
        $('#totalAmount').text("Rs." + $("#TBSelectedSeatsPrice").val());*/
        return true;
    }

    function remove_seat(seatno,seatprice)
    {
        str = new String($("#TBSelectedSeats").val());
        i = str.indexOf($.trim(seatno));
        if(i >= 0)
        {
            inext = str.indexOf(',',i);
            if(inext == -1 && i == 0)
            {
                $("#TBSelectedSeats").val("");
                $("#TBSelectedSeats").trigger('input');
            }
            else if(i == 0)
            {
                $("#TBSelectedSeats").val(str.substring(inext+1));
                $("#TBSelectedSeats").trigger('input');
            }
            else
            {
                if(inext == -1)
                {
                    $("#TBSelectedSeats").val(str.substring(0,i-1));
                    $("#TBSelectedSeats").trigger('input');
                }
                else
                {
                    $("#TBSelectedSeats").val(str.substring(0,i-1) + str.substring(inext));
                    $("#TBSelectedSeats").trigger('input');
                }
            }
        }
        $("#TBSelectedSeatsPrice").val(parseFloat($("#TBSelectedSeatsPrice").val()) - parseFloat(seatprice));
        $("#TBSelectedSeatsPrice").trigger('input');
        /*$('#selectedSeats').text($('#TBSelectedSeats').val());
        $('#totalAmount').text("Rs." + $("#TBSelectedSeatsPrice").val());*/
    }

</script>

